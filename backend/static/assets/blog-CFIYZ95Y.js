import{r as t,j as e,L as b,i as j,t as N}from"./index-CqnK1jY6.js";const y=()=>{const[l,o]=t.useState([]),[n,c]=t.useState(!0);return t.useEffect(()=>{(async()=>{try{const r=await j.get("/blog/category/");o(r.data)}catch(r){console.error("Error fetching categories",r)}finally{c(!1)}})()},[]),n?e.jsx("p",{children:"Loading categories..."}):e.jsx("div",{className:"blog-categories",children:e.jsx("ul",{children:l.map(a=>e.jsx("li",{children:e.jsx(b,{className:"li",to:a.link,children:a.name})},a.link))})})},w=()=>{const[l,o]=t.useState(!0),[n,c]=t.useState(!1),[a,r]=t.useState([]),[d,h]=t.useState(""),{name:i}=N(),m=t.useRef(0),u=()=>{const s=window.scrollY;c(s>m.current),m.current=s};t.useEffect(()=>(window.addEventListener("scroll",u),()=>window.removeEventListener("scroll",u)),[]),t.useEffect(()=>{i&&h(i)},[i]),t.useEffect(()=>{const s=localStorage.getItem("access_token");(async()=>{try{const g=await j.get("/blog/list/",{headers:s?{Authorization:`Bearer ${s}`}:{},withCredentials:!0});r(g.data)}catch(g){console.error("Failed to fetch blog data:",g)}finally{o(!1)}})()},[]);const f=d?a.filter(s=>s.categories.includes(d)):a,p=()=>l?e.jsx("p",{className:"blog-loading",children:"Loading posts..."}):f.length===0?e.jsx("p",{className:"blog-empty",children:"No blog posts found in this category."}):e.jsx("div",{className:"blog-grid",children:f.filter(s=>s.image).map(s=>{const x=s.image.startsWith("http")?s.image:`http://127.0.0.1:8000${s.image}`;return e.jsxs("article",{className:"blog-card",children:[e.jsx("img",{src:x,alt:s.title,className:"blog-img"}),e.jsxs("div",{className:"blog-content",children:[e.jsx("h2",{className:"blog-title",children:s.title}),e.jsxs("p",{className:"blog-meta",children:["By ",e.jsx("strong",{children:s.author_username})," Â·"," ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("p",{className:"blog-snippet",children:[s.content.slice(0,220),"...",e.jsx("span",{className:"blog-readmore",children:" Read more"})]})]})]},s.title)})});return e.jsxs("section",{className:"blog",children:[e.jsx("header",{className:n?"blog-hero scroll":"blog-hero",children:e.jsxs("div",{className:"blog-header-content",children:[e.jsx("h1",{className:"blog-title",children:"Abren Coffee Insights"}),e.jsx("p",{className:"blog-subtitle",children:"Explore expert takes, brewing tips, and stories behind your favorite blends."})]})}),e.jsx(y,{setCategory:h}),e.jsx("main",{className:"blog-container",children:p()})]})};export{w as default};
