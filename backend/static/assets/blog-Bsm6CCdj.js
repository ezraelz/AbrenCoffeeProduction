import{j as s,r as t,u as y,a as C,i as S}from"./index-CbhMAO2N.js";const v=({categories:n,setCategory:i,allCat:l})=>n.length?s.jsx("div",{className:"blog-categories",children:s.jsxs("ul",{children:[s.jsx("li",{children:s.jsx("button",{className:"li",onClick:()=>l,children:"All Articles"})}),n.map(r=>s.jsx("li",{children:s.jsx("button",{className:"li",onClick:()=>i(r.id),children:r.name})},r.id))]})}):s.jsx("p",{children:"Loading categories..."}),w="https://abrencoffeeproduction.onrender.com",k=()=>{const[n,i]=t.useState(!0),[l,r]=t.useState([]),{id:d}=y(),[o,g]=t.useState(null),c=C(),u=t.useRef(0),[p,f]=t.useState(!1),h=()=>{const e=window.scrollY;f(e>u.current),u.current=e};t.useEffect(()=>(window.addEventListener("scroll",h),()=>window.removeEventListener("scroll",h)),[]),t.useEffect(()=>{g(d?parseInt(d):null)},[d]),t.useEffect(()=>{const e=localStorage.getItem("access_token");(async j=>{try{const m=await S.get("/blog/list/",{headers:e?{Authorization:`Bearer ${e}`}:{},withCredentials:!0,params:j?{category:j}:{}});r(m.data)}catch(m){console.error("Failed to fetch blog data:",m)}finally{i(!1)}})(o!==null?o:void 0)},[o]);const x=e=>{g(e),c(e===null?"/blog":`/blog/category/${e}`)},b=t.useMemo(()=>o?l.filter(e=>Number(e.category)===o):l,[o,l]),N=t.useMemo(()=>[...new Map(l.map(a=>[a.category,{id:Number(a.category),name:a.category_name,link:`/blog/category/${a.category}`}])).values()],[l]);return s.jsxs("section",{className:"blog",children:[s.jsx("header",{className:p?"blog-hero scroll":"blog-hero",children:s.jsxs("div",{className:"blog-header-content",children:[s.jsx("h1",{className:"blog-title",children:"Abren Coffee Insights"}),s.jsx("p",{className:"blog-subtitle",children:"Explore expert takes, brewing tips, and stories behind your favorite blends."})]})}),s.jsxs("main",{className:"blog-container",children:[s.jsx("div",{className:"blog-catagory-menu",children:s.jsx(v,{allCat:()=>x(null),categories:N,setCategory:x})}),n?s.jsx("p",{className:"blog-loading",children:"Loading posts..."}):b.length===0?s.jsx("p",{className:"blog-empty",children:"No blog posts found in this category."}):s.jsx("div",{className:"blog-grid",children:b.filter(e=>e.image).map(e=>{const a=e.image.startsWith("http")?e.image:`${w}${e.image}`;return s.jsxs("article",{className:"blog-card",onClick:()=>c(`/blog/detail/${e.id}`),children:[s.jsx("img",{src:a,alt:e.title,className:"blog-img"}),s.jsxs("div",{className:"blog-content",children:[s.jsx("h2",{className:"blog-title",children:e.title}),s.jsx("p",{className:"category",children:e.category_name}),s.jsxs("p",{className:"blog-meta",children:["By ",s.jsx("strong",{children:e.author_username})," Â·"," ",new Date(e.created_at).toLocaleDateString()]}),s.jsxs("p",{className:"blog-snippet",children:[e.content.slice(0,320),"..."]}),s.jsx("button",{className:"blog-readmore",onClick:()=>c(`blog/detail/${e.id}`),children:"Read more"})]})]},e.id)})})]})]})};export{k as default};
