import{r as a,a as S,j as e,i as c,y as u}from"./index-gJE2LY-K.js";import{B as N}from"./backbutton-C83BcxP1.js";const L=()=>{const[r,d]=a.useState(""),[n,g]=a.useState(""),[m,o]=a.useState(!1),[i,h]=a.useState(null),t=S();a.useEffect(()=>{(async()=>{try{(await c.get("/api/auth/status/",{withCredentials:!0})).data.isAuthenticated&&t(-1)}catch{u.error("Session check failed:")}})()},[t]);const p=async s=>{s.preventDefault(),h(null),o(!0);try{const l=await c.post("/api/login/",{username:r,password:n}),{access:x,refresh:f,email:j,username:v}=l.data;localStorage.setItem("access_token",x),localStorage.setItem("refresh_token",f),localStorage.setItem("email",j),localStorage.setItem("username",v),localStorage.setItem("isLoggedIn","true"),t("/")}catch{u.error("Login failed. Please try again."),t(-1)}finally{o(!0)}};return m?e.jsxs("div",{className:"main",children:[e.jsx("div",{className:"outer",children:e.jsx("div",{className:"inner"})}),"Loaging In..."]}):e.jsxs("div",{className:"login-container",children:[e.jsx(N,{}),e.jsx("h2",{className:"login-title",children:"Login"}),e.jsxs("form",{onSubmit:p,className:"login-box",children:[e.jsx("input",{type:"text",value:r,onChange:s=>d(s.target.value),placeholder:"Username",className:"login-input",required:!0}),e.jsx("input",{type:"password",value:n,onChange:s=>g(s.target.value),placeholder:"Password",className:"login-input",required:!0}),e.jsx("button",{type:"submit",className:"login-button",children:"Login"})]}),i&&e.jsx("div",{className:"error-message",children:i}),e.jsx("div",{className:"login-footer",children:e.jsxs("p",{onClick:()=>t("/forgot-password"),children:["Forgot your password? ",e.jsx("span",{children:"Reset here"})]})})]})};export{L as default};
