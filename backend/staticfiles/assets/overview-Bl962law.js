import{r as t,j as s,i as r,y as Z}from"./index-CYbfX4g-.js";import{m as n,R as ss,L as es,C as ts,X as as,Y as rs,T as ls,a as ds}from"./LineChart-BGwDahGx.js";import"./tiny-invariant-CopsF_GD.js";const hs=()=>{const[k,L]=t.useState([]),[o,R]=t.useState([]),[C,_]=t.useState(0),[h,T]=t.useState(0),[w,O]=t.useState(0),[x,b]=t.useState(0),[A,D]=t.useState(0),[E,F]=t.useState(0),[$,Y]=t.useState(0),[j,u]=t.useState(null),[i,I]=t.useState(""),[c,m]=t.useState(1),[p,S]=t.useState(!0),d=5;t.useEffect(()=>{(async()=>{const l=localStorage.getItem("access_token");if(!l)return;if(!l){u("You must be logged in."),S(!1);return}const a={headers:{Authorization:`Bearer ${l}`}};try{const[z,B,G,W,q,H,J,Q,V]=await Promise.all([r.get("/adminPanel/total-products/",a),r.get("/adminPanel/total-stock/",a),r.get("/adminPanel/total-sales/",a),r.get("/adminPanel/users/",a),r.get("/adminPanel/total-orders/",a),r.get("/adminPanel/completed_orders/",a),r.get("/adminPanel/top-products/",a),r.get("/adminPanel/sales-per-day/",a),r.get("/adminPanel/total-refunds/",a)]);_(z.data.total_products),T(B.data.total_stock),O(G.data.total_sales),Y(W.data.length),b(q.data.total_orders),F(H.data.total_completed_orders),L(J.data),R(Q.data.sales_per_day||[]),D(V.data)}catch{Z.error("Error fetching admin data:"),u("Failed to load admin statistics.")}finally{S(!1)}})()},[]);const g=o.filter(e=>e.total_sales>0&&e.day.toLowerCase().includes(i.toLowerCase())),P=c*d,K=P-d,f=g.slice(K,P),M=Math.ceil(g.length/d),y=k.filter(e=>e.name.toLowerCase().includes(i.toLowerCase())),v=(c>0?c:1)*d,U=v-d,N=y.slice(U,v),X=Math.ceil(y.length/d);return p?s.jsx("div",{className:"main",children:"Loading..."}):s.jsx("div",{className:"overview",children:s.jsxs("div",{className:"cards-container ",children:[j&&s.jsx("div",{className:"alert alert-danger w-100 text-center",children:j}),p?s.jsx(s.Fragment,{children:"Loading Faild. Refresh the page!"}):s.jsxs("div",{className:"cards",children:[s.jsxs(n.div,{className:"card",children:[s.jsx("p",{children:C}),s.jsx("h2",{children:"Total Products"}),s.jsxs("small",{className:h<10?"less-stock":"",children:[s.jsx("p",{children:"Stock"}),s.jsx("p",{children:h})]})]}),s.jsxs(n.div,{className:"card",children:[s.jsxs("p",{children:["$",w]}),s.jsx("h2",{children:"Total Sales"}),s.jsxs("small",{children:[s.jsx("p",{children:"Refund"}),s.jsxs("p",{children:["$",A]})]})]}),s.jsxs(n.div,{className:"card",children:[s.jsx("p",{children:$}),s.jsx("h2",{children:"Total Users"}),s.jsxs("small",{children:[s.jsx("p",{children:"New"}),s.jsx("p",{children:"0"})]})]}),s.jsxs(n.div,{className:"card",children:[s.jsx("p",{children:x>0?x.toLocaleString():"0"}),s.jsx("h2",{children:"Total Orders"}),s.jsxs("small",{children:[s.jsx("p",{children:"Completed"}),s.jsx("p",{children:E})]})]})]}),s.jsxs("div",{className:"users-top-products",children:[s.jsxs("div",{className:"top-products",children:[s.jsxs("div",{className:"top-product-head",children:[s.jsx("h3",{children:"Top Products"}),s.jsx("div",{className:"search-bar",children:s.jsx("input",{type:"text",placeholder:"Search...",value:i,onChange:e=>I(e.target.value)})})]}),s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"#"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Popularity"}),s.jsx("th",{children:"Sales"})]})}),s.jsx("tbody",{children:N.length>0?N.map((e,l)=>s.jsxs("tr",{children:[s.jsx("td",{children:l+1}),s.jsx("td",{children:e.name}),s.jsxs("td",{children:[e.popularity,"%"]}),s.jsxs("td",{children:["$",e.sales.toLocaleString()]})]},e.id)):s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"text-center",children:"No top products found."})})})]}),s.jsx("div",{className:"pagination",children:[...Array(X).keys()].map(e=>s.jsx("button",{onClick:()=>m(e+1),className:c===e+1?"active":"",children:e+1},e+1))})]}),s.jsxs("div",{className:"sales-per-day",children:[s.jsx("h3",{children:"Sales Per Day"}),s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Total Sales"})]})}),s.jsx("tbody",{children:f.length>0?f.map((e,l)=>s.jsxs("tr",{children:[s.jsx("td",{children:e.day}),s.jsxs("td",{children:["$",e.total_sales]})]},l)):s.jsx("tr",{children:s.jsx("td",{colSpan:2,children:"No daily sales data found."})})})]}),s.jsx("div",{className:"pagination",children:[...Array(M).keys()].map(e=>s.jsx("button",{onClick:()=>m(e+1),className:c===e+1?"active":"",children:e+1},e+1))})]})]}),s.jsx("div",{className:"sales-chart",children:s.jsxs("div",{className:"sales-per-day-chart",children:[s.jsx("h3",{children:"Sales Per Day"}),s.jsx(ss,{width:"100%",height:300,children:s.jsxs(es,{data:o,children:[s.jsx(ts,{strokeDasharray:"3 3"}),s.jsx(as,{dataKey:"day"}),s.jsx(rs,{}),s.jsx(ls,{}),s.jsx(ds,{type:"monotone",dataKey:"total_sales",stroke:"#8884d8",strokeWidth:2})]})})]})})]})})};export{hs as default};
