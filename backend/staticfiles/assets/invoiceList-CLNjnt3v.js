import{r as n,a as D,j as e,B as N,D as A,i as m,y as c}from"./index-CYbfX4g-.js";/* empty css                */import{C as E}from"./confirmDelete-DOY78CcP.js";import{d as F}from"./index-BJQuPtR-.js";const $=()=>{const[f,a]=n.useState(!1),[o,l]=n.useState([]),[d,h]=n.useState(!1),g=D(),[u,p]=n.useState(""),[i,v]=n.useState(1),r=5,C=async()=>{h(!0);try{const t=localStorage.getItem("access_token"),s=await m.get("/orders/invoices/",{headers:t?{Authorization:`Bearer ${t}`}:{}});l(s.data),console.log("Invoices loaded:",s.data)}catch(t){console.error("Error loading invoices:",t),c.error("❌ Failed to load invoices")}h(!1)};n.useEffect(()=>{C()},[]);const y=()=>a(!0),b=async t=>{a(!1);const s=localStorage.getItem("access_token");try{await m.delete(`/orders/invoices/delete/${t}/`,{headers:{Authorization:`Bearer ${s}`}}),c.success("✅ Invoice deleted successfully!"),l(o.filter(S=>S.id!==t))}catch{c.error("❌ Failed to delete invoice.")}},x=o.filter(t=>t.status.toLowerCase().includes(u.toLowerCase())),j=i*r,k=j-r,w=x.slice(k,j),I=Math.ceil(x.length/r);return e.jsxs("div",{className:"invoices-list-container",children:[e.jsx("h2",{children:"All Invoices"}),e.jsx("input",{type:"text",placeholder:"Search by status...",value:u,onChange:t=>p(t.target.value),className:"invoice-search-input",style:{marginBottom:"1rem",padding:"0.5rem",width:"250px"}}),d?e.jsx("p",{children:"Loading..."}):e.jsxs("table",{className:"invoices-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Invoice ID"}),e.jsx("th",{children:"Order"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:w.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:s+1+(i-1)*r}),e.jsx("td",{children:t.id}),e.jsx("td",{children:t.order}),e.jsx("td",{children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{children:t.status}),e.jsxs("td",{className:"action-buttons",children:[e.jsx("button",{title:"detail",onClick:()=>g(`/admin/invoices/detail/${t.id}`),children:e.jsx(N,{})}),e.jsx("button",{title:"edit",onClick:()=>alert(`Editing ${t.id}`),children:e.jsx(A,{})}),e.jsx("button",{title:"delete",onClick:y,children:e.jsx(F,{})}),t.pdf_file&&e.jsx("a",{href:t.pdf_file,target:"_blank",rel:"noopener noreferrer",download:!0,className:"download-link",children:e.jsx("button",{children:"Download"})}),e.jsx(E,{isOpen:f,title:"Delete order",message:"Are you sure you want to delete this order? This action cannot be undone.",onConfirm:()=>b(t.id),onCancel:()=>a(!1)})]})]},t.id))})]}),o.length===0&&!d&&e.jsx("p",{children:"No invoices found."}),e.jsx("div",{className:"pagination",children:[...Array(I).keys()].map(t=>e.jsx("button",{onClick:()=>v(t+1),className:i===t+1?"active":"",children:t+1},t+1))})]})};export{$ as default};
