import{r,w as C,j as e,x as h}from"./index-CYbfX4g-.js";const E=({handleAddToCart:p})=>{var l;const[a,f]=r.useState(null),{id:n}=C(),[t,g]=r.useState(null),[c,m]=r.useState(!0),[i,x]=r.useState(null),d=(t==null?void 0:t.stock)===0;if(r.useEffect(()=>{(async()=>{try{const s=await h.get(`http://127.0.0.1:8000/products/detail/${n}/`);g(s.data),console.log(s.data)}catch(s){console.error("Error fetching product:",s),x("Failed to load product.")}finally{m(!1)}})()},[n]),r.useEffect(()=>{(async()=>{const s=localStorage.getItem("access_token"),S={headers:s?{Authorization:`Bearer ${s}`}:{},withCredentials:!0},u=await h.get("http://127.0.0.1:8000/cart/",S);console.log(u.data),f(u.data)})()},[]),c)return e.jsx("p",{children:"Loading..."});if(i)return e.jsx("p",{children:i});if(!t)return e.jsx("p",{children:"Product not found."});const j=t.image.startsWith("http")?t.image:`http://127.0.0.1:8000${t.image}`,P=((l=a==null?void 0:a.cart_items)==null?void 0:l.some(o=>o.product.id===(t==null?void 0:t.id)))??!1;return e.jsx("div",{className:"single-product",children:e.jsx("div",{className:"product-grid",children:e.jsxs("article",{className:"product-card",children:[e.jsx("img",{src:j,alt:t.name}),e.jsxs("div",{className:"description",children:[e.jsx("h2",{children:t.name}),e.jsxs("p",{children:["Price: $",Number(t.price).toFixed(2)]}),e.jsx("p",{children:t.description}),e.jsx("button",{className:"addCart",onClick:()=>p(t),disabled:c||d,type:"button",children:P?"InCart":c?"Adding...":d?"Out of Stock":"Add to Cart"})]})]})})})};export{E as default};
