import{r,u as C,k as P,j as e,i as u}from"./index-CWz2hUUw.js";const N=()=>{var l;const[a,h]=r.useState(null),{id:o}=C(),[t,p]=r.useState(null),[c,m]=r.useState(!0),[i,f]=r.useState(null),{addItem:g}=P(),d=(t==null?void 0:t.stock)===0;if(r.useEffect(()=>{(async()=>{try{const s=await u.get(`/products/detail/${o}/`);p(s.data)}catch(s){console.error("Error fetching product:",s),f("Failed to load product.")}finally{m(!1)}})()},[o]),r.useEffect(()=>{(async()=>{const s=localStorage.getItem("access_token"),k={headers:s?{Authorization:`Bearer ${s}`}:{},withCredentials:!0},S=await u.get("/cart/",k);h(S.data)})()},[]),c)return e.jsx("p",{children:"Loading..."});if(i)return e.jsx("p",{children:i});if(!t)return e.jsx("p",{children:"Product not found."});const x=t.image.startsWith("http")?t.image:`http://127.0.0.1:8000${t.image}`,j=((l=a==null?void 0:a.cart_items)==null?void 0:l.some(n=>n.product.id===(t==null?void 0:t.id)))??!1;return e.jsxs("div",{className:"single-product",children:[e.jsx("div",{className:"single-product-header",children:e.jsx("h2",{children:t.name})}),e.jsx("div",{className:"product-grid",children:e.jsxs("article",{className:"product-card",children:[e.jsx("img",{src:x,alt:t.name}),e.jsxs("div",{className:"description",children:[e.jsx("p",{children:t.description}),e.jsxs("p",{children:["Price: $",Number(t.price).toFixed(2)]}),e.jsxs("p",{children:["Quantity: ",t.quantity,"g"]}),e.jsxs("p",{children:["Stock: ",t.stock]}),e.jsx("button",{className:"addCart",onClick:()=>g(t),disabled:c||d,type:"button",children:j?"InCart":c?"Adding...":d?"Out of Stock":"Add to Cart"})]})]})})]})};export{N as default};
