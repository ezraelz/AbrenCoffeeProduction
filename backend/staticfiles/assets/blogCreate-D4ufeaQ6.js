import{r as o,j as e,i as S,y as b,C as F}from"./index-CYbfX4g-.js";import{S as _}from"./react-select.esm-BbtwjMIR.js";const B=()=>{const[m,d]=o.useState(!1),x=o.useRef(null),[y,c]=o.useState({name:""}),j=t=>{const{name:s,type:r,value:h,checked:v,files:u}=t.target;r==="file"&&(u!=null&&u[0])?c(i=>({...i,image:u[0]})):c(r==="checkbox"?i=>({...i,[s]:v}):i=>({...i,[s]:h}))},g=async t=>{t.preventDefault(),d(!0);const s=localStorage.getItem("access_token"),r=new FormData;r.append("name",y.name);try{await S.post("/blog/category/create/",r,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"multipart/form-data"}}),b.success("✅ Blog Category created successfully!"),c({name:""}),x.current&&(x.current.value="")}catch(h){b.error("❌ Failed to create blog category. Please try again."),console.error(h)}finally{d(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:g,className:"category-form",children:[e.jsx("h2",{children:"Create Blog Category"}),e.jsx("div",{className:"form-group",children:e.jsx("input",{type:"text",name:"name",placeholder:"name",value:y.name,onChange:j,className:"form-input",required:!0})}),e.jsx("button",{type:"submit",disabled:m,className:"category-form-button",children:m?"Submitting...":"Create Blog Category"})]})})},D=()=>{const[m,d]=o.useState(!1),[x,y]=o.useState([]),[c,j]=o.useState(!1),g=o.useRef(null),[t,s]=o.useState({title:"",image:"",content:"",categories:[],is_published:!1});o.useEffect(()=>{(async()=>{try{const l=localStorage.getItem("access_token"),a=await S.get("/blog/category/",{headers:{Authorization:`Bearer ${l}`}});y(a.data)}catch{b.error("❌ Failed to load categories")}})()},[]);const r=n=>{const{name:l,type:a,value:p,checked:k,files:C}=n.target;a==="file"&&(C!=null&&C[0])?s(f=>({...f,image:C[0]})):s(a==="checkbox"?f=>({...f,[l]:k}):f=>({...f,[l]:p}))},h=n=>{s(l=>({...l,categories:n.map(a=>Number(a.value))}))},v=async n=>{n.preventDefault(),j(!0);const l=localStorage.getItem("access_token"),a=new FormData;a.append("title",t.title),a.append("content",t.content),a.append("is_published",String(t.is_published)),t.categories.forEach(p=>a.append("categories",String(p))),t.image instanceof File&&a.append("image",t.image);try{await S.post("/blog/create/",a,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"}}),b.success("✅ Blog created successfully!"),s({title:"",image:"",content:"",categories:[],is_published:!1}),g.current&&(g.current.value="")}catch(p){b.error("❌ Failed to create blog. Please try again."),console.error(p)}finally{j(!1)}},u=()=>{d(!m)},i=()=>{d(!m)},N=()=>e.jsxs("div",{className:"category-create",children:[e.jsx("button",{className:"close-btn",onClick:i,children:"×"}),e.jsx(B,{})]});return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:v,className:"blog-form",children:[e.jsx("h2",{children:"Create New Blog"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Title"}),e.jsx("input",{type:"text",name:"title",placeholder:"title",value:t.title,onChange:r,className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Content"}),e.jsx("input",{type:"textArea",name:"content",placeholder:"content",className:"form-input",value:t.content,onChange:r})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Image"}),e.jsx("input",{title:"file",type:"file",name:"image",ref:g,onChange:r,accept:"image/*",className:"form-input",required:!0}),t.image instanceof File&&e.jsx("img",{src:URL.createObjectURL(t.image),alt:"Preview",className:"form-preview"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Categories ",e.jsxs("button",{onClick:()=>u(),children:[e.jsx(F,{})," Add"]})]}),e.jsx(_,{isMulti:!0,placeholder:"Select categories",onChange:h,options:x.map(n=>({value:n.id,label:n.name}))})]}),e.jsxs("div",{className:"form-checkbox",children:[e.jsx("input",{type:"checkbox",name:"is_published",placeholder:"is_published",checked:t.is_published,onChange:r}),e.jsx("label",{htmlFor:"is_published",children:"Publish Immediately"})]}),e.jsx("button",{type:"submit",disabled:c,className:"form-button",children:c?"Submitting...":"Create Blog"})]}),m?e.jsx("div",{className:"category-create",children:N()}):e.jsx(e.Fragment,{})]})};export{D as default};
